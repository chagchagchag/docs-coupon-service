(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[61],{5667:function(e,s,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project-overview/prometheus-grafana-setting",function(){return r(3719)}])},3719:function(e,s,r){"use strict";r.r(s),r.d(s,{__toc:function(){return b},default:function(){return f}});var n=r(5893),i=r(2673),o=r(373),l=r(8426);r(9128);var a=r(2643),t={src:"/docs-coupon-service/_next/static/media/0.70155138.png",height:1192,width:1301,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAHCAMAAAACh/xsAAAAQlBMVEX////+/v79/f38/Pz7+/v6+vr5+fn5+Pj4+Pj29vb19fX09PTz8/Py8vLx8fHU1dXT09PR0dHQ0NDPz9DNzs7Mzc2LO6/NAAAAL0lEQVR42gWAgQ2AMAzDnKmMC/j/0sYon6KaN9sF5nI3TafY1Z4cMk8cdFsZAUJ+svwbI1HbFKMAAAAASUVORK5CYII=",blurWidth:8,blurHeight:7},c={src:"/docs-coupon-service/_next/static/media/1.9f5431d4.png",height:1159,width:1802,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAIAAAD38zoCAAAAhElEQVR42mOot4vrck2pd0wutExMMU0JN8v0N86z181i8FINDNOKMZR3j7UzibMzUpHztNdINFCOYNCVsDYUtTfVdjOyDNQw9FJXdFKVdJUTt2UQ5VERY5GVkndUMstQtswVU3DmZ5UR4FNlYGLgEBSQFBMWEeYEKmKQlpAWFJRiYuQEAEq3F0wKLoNlAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:5},h={src:"/docs-coupon-service/_next/static/media/2.62a42fa0.png",height:1161,width:1801,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAIAAAD38zoCAAAAhUlEQVR42mOot4/rdksts43JswhKNQ31N0oONMm3181i8FINCtOKNpD3inB1jnJzUpP3ttdINFCOYNCVtNYTcPRwtPfyc3V0s3CwtlIScZOXsGUQ51flY5By9XC39co3c812dHXiZJAV5FdlYGHi5OESU9dQNrPQt7Ay0NZW5+EWZ2bmAgCRVRn3Nmaq7wAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:5},d={src:"/docs-coupon-service/_next/static/media/3.700af550.png",height:1159,width:2770,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAADCAIAAAAhqtkfAAAAU0lEQVR42mPQ1TWWU1SVkVEQE5U3NZH19lKzsdHR1tZj0NI1kZJRsDB3MDGx0tc3jIs1iI7WlFOSZ9DWNZSWU5SRVZCUUzbV1dI3cjS1dDEwtgUA2RMM/Q6H1AAAAAAASUVORK5CYII=",blurWidth:8,blurHeight:3},p={src:"/docs-coupon-service/_next/static/media/4.d8c3cc4c.png",height:1169,width:2775,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAADCAIAAAAhqtkfAAAAUklEQVR42mOQk1MUEZOWlpFX1zCQktFn41AUFZeTkpJl4BMQ5eUXk5ORNLCK8AuOcHGW5uET5RcQYxAUkuAXEJaS1QAq9A+QCwrW5BcQEhSSAABK1gktHnlw5QAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:3},x={src:"/docs-coupon-service/_next/static/media/5.ba7d1c4c.png",height:1169,width:1829,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAIAAAD38zoCAAAAgElEQVR42mMwNTBWUdcxNLJQUFITlZCRkVcWl5KTlFFgUFfTlpSW09TWMzKxUFbV5OEXEZeSB8oxMDCI2juoefnaq2jaKWnZegf6KygpiUrIMfDwicrISGhoaoiJKwgISsgrKUvKgHXw8zBJKFoqajoJCbKLiMsICksCjZKQlgMAG30PtIlHvLQAAAAASUVORK5CYII=",blurWidth:8,blurHeight:5},k={src:"/docs-coupon-service/_next/static/media/6.7f0dc2b3.png",height:1169,width:1832,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAIAAAD38zoCAAAAg0lEQVR42mMwNTBRUdcxNDJXUdOWkFaQlJYXEZeWklFgUFXRVFLWsLV30TOykVLUlVdUUVbVEpOSZeDlFwGy1DUNGBgYmJlYpeWUFZTUxKXkGPj4Rbm5eDW0ZBIy8wLCw3l5uMWl5SWk5RkkpYTl1O30zAMs7JzMrJ0VVPTFpeQlpOUBGiURJBIb8R8AAAAASUVORK5CYII=",blurWidth:8,blurHeight:5},j={src:"/docs-coupon-service/_next/static/media/7.123b3987.png",height:1169,width:2775,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAADCAIAAAAhqtkfAAAAT0lEQVR42mPQ1tK1tjTR0VOVkpGXkFaQlJEXl5ZXUFRhkBQX8/W0cnUzUtPQVFTRVlIFIVUNPQYuPhE1U0cVNQNZRXUFZU0FZQ0gKaeoBgCaZArE2Mdx/QAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:3},y={src:"/docs-coupon-service/_next/static/media/8.1efb2b44.png",height:1762,width:1808,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAIAAABLbSncAAAAtUlEQVR42jXJ2w7BMACA4RLE+VS02aZru06nZegiiDFbSMYuef9nsQuS/+r/wHYTaal3obEJR9hxuaBC6kADtQwl4bdj4mtD2JL6iss1FRr0ukNksVOc78/FyiTapHJ9ZjICwxEczzzsRo2W0xm4QoZz6jlUgVod6hXPnybN/PgiJsjGtlsGQAXuDH9/Dq9C3h/+FJPyIouA/gAi7AXqVG+zarO8f+j2oENYfM0WgZpTjqwffAEVRxrrjEEJlwAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},m={src:"/docs-coupon-service/_next/static/media/9.9c0a7048.png",height:1879,width:1808,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAIAAABLbSncAAAAnUlEQVR42h1NMQ7CMBC7S+4CoiytGFiYkVgQZeL/DyqopU3S5I4rlmUPtmV83Ps5V4cQs6Q0iYgCNOxdXFJKcbfflz9UFAHGtPpxis2xCSEsyySqgICIDsBxYIfIHLwnsEDBYEJmIpWZjHm1DqqqGdmsZPy852GIICgKpdYi3pLTrT+0HWENutWTDZiKK+S79fu8vtrzBaBuZ0RE8APQcVGZbTHgDAAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},g={src:"/docs-coupon-service/_next/static/media/10.88941e78.png",height:1879,width:1808,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAIAAABLbSncAAAApUlEQVR42kWLuwrCMBhGIzop9mJM/jT3VNpIKy6VFgcVFAd10EkEwfd/DEsLCmf5ON9Bn3f1fJXXWyN1AYngylFuUpui1JWTQC+ydbXZZn4VxABck0SjwRDq2p7OO18edL6/PO7ZMsdUomlAOQfvPWU2jKgyLpG2jVA4HTHbuOKIZ2MCChMO3HQiwoQ5aQsmFBOmoxNRTPEcgMv+2PIXbd4PEOYnvkfkF4Ao+M9eAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},A={src:"/docs-coupon-service/_next/static/media/11.f911006c.png",height:1879,width:1808,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAIAAABLbSncAAAAsklEQVR42j3N3QqCMBTA8UUQJVl+b87pdOpsfuXIIIu66qK6qLeI3v8JmgSdiwOHH4c/2Hd9yiu5O2zE1oEhwpGHI0YZyDORsOJ8uTbyyKshiBgKqDKw1O00K8tazjSdxqnnziGOlCmwCEn6fihEk/I2a+8oiJUBNbfH6f15TaYuZYLLJwoSiEOgLUyW87qTpuOr27aB6o8fpgVXa9ewfUQoxBSRMT6CYXqOh30S/5r//QUCWxe+LXMPqQAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},u={src:"/docs-coupon-service/_next/static/media/12.2b313be6.png",height:1879,width:1808,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAIAAABLbSncAAAAoUlEQVR42hWMRxLDIBAE+YN9sgJp0YogggAl2wf//1NGl66umkBi2jl6NAHQTXrvejFQkFSSn8t1kIVj6aTw81P0POADO5JCZZTPemEMhNIAgNq+RkZyvQAtGk+5cn6d0ORyGhvJEgoXaFxq1DaMTDUfRkm247OWM637mo948wRl7iCkrZ20YtczmEzzWfuR3otvqZfzWaGJefeh1O2tbfwD2UcfPkHspPsAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},v={src:"/docs-coupon-service/_next/static/media/2.a712b35b.png",height:801,width:1533,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAECAIAAAA8r+mnAAAAXElEQVR42g3LMQ6AIAwF0N8KitGEjfN7Db2Pk04uCpRW5pdH+7ENPmUJcWnzBDXSUuCUrvs0TkVcXLEEU23cjV4X5ggjxzlnD60w8WNg6qc9xFVUpY2TL4B0M3w/9lAvMy6lMzsAAAAASUVORK5CYII=",blurWidth:8,blurHeight:4},w={src:"/docs-coupon-service/_next/static/media/1.23f4460b.png",height:872,width:626,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAICAIAAABVpBlvAAAAoElEQVR42mMwt3Fx8fQztbSUV9aRV9ZSVNVmcHI1zMnzjos1i47RVFTTV1LXY/DyYvD01taU0QoPY5BXEBLgF2Twiqkpa6wsqS7LLitzjWxwiahncPVyzMwNio3zCQh2CAh2TstwYvD0knJx17GxsPMwF3HQlUuIkGbw8lZ38zSysnAy01WWENEJCdZkcHXXTMmwTExyiovVCwrWSEnTAADd1CW8NMbI5QAAAABJRU5ErkJggg==",blurWidth:6,blurHeight:8};let b=[{depth:2,value:"prometheus, grafana 세팅",id:"prometheus-grafana-세팅"},{depth:2,value:"coupon-api",id:"coupon-api"},{depth:3,value:"build.gradle.kts",id:"buildgradlekts"},{depth:3,value:"application-api.yml",id:"application-apiyml"},{depth:2,value:"coupon-issuer",id:"coupon-issuer"},{depth:3,value:"build.gradle.kts",id:"buildgradlekts-1"},{depth:3,value:"application-issuer.yml",id:"application-issueryml"},{depth:2,value:"coupon-api, coupon-issuer 모듈 구동",id:"coupon-api-coupon-issuer-모듈-구동"},{depth:2,value:"prometheus 메트릭 조회 가능 여부 확인",id:"prometheus-메트릭-조회-가능-여부-확인"},{depth:2,value:"Docker-Compose Prometheus, Grafana 세팅",id:"docker-compose-prometheus-grafana-세팅"},{depth:3,value:"monitoring/prometheus/config/config.yml",id:"monitoringprometheusconfigconfigyml"},{depth:3,value:"docker-compose.yml",id:"docker-composeyml"},{depth:2,value:"Grafana 세팅",id:"grafana-세팅"},{depth:3,value:"Grafana 접속 & 패스워드 변경",id:"grafana-접속--패스워드-변경"},{depth:3,value:"Dashboard 생성, Prometheus 세팅",id:"dashboard-생성-prometheus-세팅"},{depth:2,value:"Prometheus 대시보드",id:"prometheus-대시보드"},{depth:2,value:"지표들을 지우고 싶다면",id:"지표들을-지우고-싶다면"}];function _createMdxContent(e){let s=Object.assign({h2:"h2",p:"p",h3:"h3",code:"code",pre:"pre",span:"span",a:"a",img:"img"},(0,a.a)(),e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h2,{id:"prometheus-grafana-세팅",children:"prometheus, grafana 세팅"}),"\n",(0,n.jsxs)(s.p,{children:["Prometheus 를 통해 애플리케이션이 모니터링 가능하도록 하고, Grafana 로 모니터링하는 과정을 설명합니다.",(0,n.jsx)("br",{}),"\r\n이론적인 내용이나 개념도 설명할까 했는데, 피곤해서 거기까지는 설명을 못하고 어떻게 하는지만 설명을 남겨두기로 했습니다.",(0,n.jsx)("br",{})]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsx)(s.h2,{id:"coupon-api",children:"coupon-api"}),"\n",(0,n.jsx)(s.h3,{id:"buildgradlekts",children:"build.gradle.kts"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"spring-boot-starter-actuator"}),", ",(0,n.jsx)(s.code,{children:"micrometer-registry-prometheus"})," 를 의존성으로 추가해줍니다."]}),"\n",(0,n.jsx)(s.pre,{"data-language":"kotlin","data-theme":"default",filename:"build.gradle.kts",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"kotlin","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line highlighted",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"dependencies"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// prometheus"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"implementation"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"org.springframework.boot:spring-boot-starter-actuator"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"implementation"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"io.micrometer:micrometer-registry-prometheus"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsx)(s.h3,{id:"application-apiyml",children:"application-api.yml"}),"\n",(0,n.jsxs)(s.p,{children:["application-api.yml 파일에 ",(0,n.jsx)(s.code,{children:"spring.application.name"}),", ",(0,n.jsx)(s.code,{children:"server.tomcat.mbeanregistry.enabled"}),", ",(0,n.jsx)(s.code,{children:"management.metrics.tags.application"}),", ",(0,n.jsx)(s.code,{children:"management.endpoints.web.exposure.include = prometheus"}),"를 추가해줍니다."]}),"\n",(0,n.jsx)(s.pre,{"data-language":"yaml","data-theme":"default",filename:"application-api.yml",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"yaml","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"spring"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"application"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line highlighted",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"name"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"coupon-api"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# ..."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# ..."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"server"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"port"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"8080"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"tomcat"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"mbeanregistry"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"enabled"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"true"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"management"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"metrics"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"tags"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"application"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"${spring.application.name}"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"endpoints"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"web"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"exposure"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"include"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"prometheus"})]})]})}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsx)(s.h2,{id:"coupon-issuer",children:"coupon-issuer"}),"\n",(0,n.jsxs)(s.p,{children:["이번에는 ",(0,n.jsx)(s.code,{children:"coupon-issuer"})," 측의 설정입니다.",(0,n.jsx)("br",{})]}),"\n",(0,n.jsx)(s.h3,{id:"buildgradlekts-1",children:"build.gradle.kts"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"spring-boot-starter-actuator"}),", ",(0,n.jsx)(s.code,{children:"micrometer-registry-prometheus"})," 를 의존성으로 추가해줍니다."]}),"\n",(0,n.jsx)(s.pre,{"data-language":"kotlin","data-theme":"default",filename:"build.gradle.kts",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"kotlin","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line highlighted",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"dependencies"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// prometheus"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"implementation"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"org.springframework.boot:spring-boot-starter-actuator"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"	"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"implementation"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"io.micrometer:micrometer-registry-prometheus"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsx)(s.h3,{id:"application-issueryml",children:"application-issuer.yml"}),"\n",(0,n.jsxs)(s.p,{children:["application-issuer.yml 파일에 ",(0,n.jsx)(s.code,{children:"spring.application.name"}),", ",(0,n.jsx)(s.code,{children:"server.tomcat.mbeanregistry.enabled"}),", ",(0,n.jsx)(s.code,{children:"management.metrics.tags.application"}),", ",(0,n.jsx)(s.code,{children:"management.endpoints.web.exposure.include = prometheus"}),"를 추가해줍니다."]}),"\n",(0,n.jsx)(s.pre,{"data-language":"yaml","data-theme":"default",filename:"application-issuer.yml",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"yaml","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"spring"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"application"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line highlighted",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"name"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"coupon-issuer"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# ..."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# ..."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"server"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"port"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"8081"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# 8081 포트를 사용합니다. 주의해주세요."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"tomcat"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"mbeanregistry"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"enabled"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"true"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"management"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"metrics"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"tags"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"application"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"${spring.application.name}"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"endpoints"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"web"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"exposure"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"include"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"prometheus"})]})]})}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsx)(s.h2,{id:"coupon-api-coupon-issuer-모듈-구동",children:"coupon-api, coupon-issuer 모듈 구동"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"coupon-api"}),", ",(0,n.jsx)(s.code,{children:"coupon-issuer"})," 모듈을 각각 스프링부트 애플리케이션으로 구동합니다. 각각 ",(0,n.jsx)(s.code,{children:"8080"}),", ",(0,n.jsx)(s.code,{children:"8081"})," 포트에 구동됩니다.",(0,n.jsx)("br",{})]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsx)(s.h2,{id:"prometheus-메트릭-조회-가능-여부-확인",children:"prometheus 메트릭 조회 가능 여부 확인"}),"\n",(0,n.jsxs)(s.p,{children:["간단하게 ",(0,n.jsx)(s.code,{children:"coupon-api"})," 측에서의 접근이 가능한지를 확인해봅니다.",(0,n.jsx)("br",{}),"\r\n",(0,n.jsx)(s.a,{href:"http://host.docker.internal:8080/actuator/prometheus",children:"http://host.docker.internal:8080/actuator/prometheus"})," 으로 접속해주세요. 만약 docker 에서 prometheus 를 띄우지 않고 로컬호스트에서 prometheus 를 구동했다면 ",(0,n.jsx)(s.a,{href:"http://localhost:8080/actuator/prometheus",children:"http://localhost:8080/actuator/prometheus"}),"으로 접속하시면 됩니다.",(0,n.jsx)("br",{})]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsxs)(s.p,{children:["아래와 같이 메트릭 조회가 성공적으로 되어야 합니다. 비정상일 경우 ",(0,n.jsx)(s.code,{children:"White Label Error Page"})," 오류가 나타납니다.\r\n",(0,n.jsx)(s.img,{placeholder:"blur",src:t})]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"coupon-issuer"})," 에 대해서도 같은 방식으로 동작을 확인해보시기 바랍니다.",(0,n.jsx)("br",{})]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsx)(s.h2,{id:"docker-compose-prometheus-grafana-세팅",children:"Docker-Compose Prometheus, Grafana 세팅"}),"\n",(0,n.jsx)(s.h3,{id:"monitoringprometheusconfigconfigyml",children:"monitoring/prometheus/config/config.yml"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"0.performance-test/monitoring/prometheus/config/config.yml"})," 을 아래와 같이 작성합니다."]}),"\n",(0,n.jsx)(s.pre,{"data-language":"yaml","data-theme":"default",filename:"config.yml",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"yaml","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"global"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"scrape_interval"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"5s"})]}),"\n",(0,n.jsx)(s.span,{className:"line highlighted",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"scrape_configs"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  - "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"job_name"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"coupon-api"'})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"metrics_path"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'/actuator/prometheus'"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"static_configs"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      - "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"targets"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" [ "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'host.docker.internal:8080'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ]"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  - "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"job_name"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"coupon-issuer"'})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"metrics_path"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'/actuator/prometheus'"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"static_configs"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      - "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"targets"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" [ "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'host.docker.internal:8081'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ]"})]})]})}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsx)(s.h3,{id:"docker-composeyml",children:"docker-compose.yml"}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"0.performance-test/monitoring/docker-compose.yml"})," 을 아래와 같이 작성합니다."]}),"\n",(0,n.jsx)(s.pre,{"data-language":"yaml","data-theme":"default",filename:"docker-compose.yml",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"yaml","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"version"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'3.7'"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"services"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line highlighted",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"prometheus"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"image"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"prom/prometheus"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"container_name"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"prometheus"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"volumes"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      - "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"./prometheus/config:/etc/prometheus"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      - "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"./prometheus/volume:/prometheus"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"ports"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      - "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"9090:9090"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"command"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      - "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'--config.file=/etc/prometheus/config.yml'"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"restart"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"always"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"networks"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      - "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"prometheus_network"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"grafana"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"image"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"grafana/grafana"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"container_name"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"grafana"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"ports"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      - "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"3000:3000"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"volumes"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      - "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"./grafana/volume:/var/lib/grafana"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"restart"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"always"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"networks"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"      - "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"prometheus_network"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"networks"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"prometheus_network"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"driver"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"bridge"})]})]})}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsxs)(s.p,{children:["작성이 완료되었으면 터미널에서 ",(0,n.jsx)(s.code,{children:"0.performance-test/monitoring/"})," 으로 이동 후에 아래의 명령어를 수행합니다."]}),"\n",(0,n.jsx)(s.pre,{"data-language":"bash","data-theme":"default",filename:"bash",hasCopyCode:!0,children:(0,n.jsx)(s.code,{"data-language":"bash","data-theme":"default",children:(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"docker-compose"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"up"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-d"})]})})}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsx)(s.h2,{id:"grafana-세팅",children:"Grafana 세팅"}),"\n",(0,n.jsx)(s.p,{children:"이번에는 Grafana 에서 Prometheus 를 설정하는 방식을 알아봅니다."}),"\n",(0,n.jsx)(s.h3,{id:"grafana-접속--패스워드-변경",children:"Grafana 접속 & 패스워드 변경"}),"\n",(0,n.jsxs)(s.p,{children:["Grafana 에 접속합니다. 접속 주소는 ",(0,n.jsx)(s.a,{href:"http://localhost:3000",children:"http://localhost:3000"})," 입니다.",(0,n.jsx)("br",{}),"\r\nid = admin, password = admin 을 입력하고 접속합니다.\r\n",(0,n.jsx)(s.img,{placeholder:"blur",src:c})]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsxs)(s.p,{children:["비밀번호를 변경하는 페이지입니다. 비밀번호를 변경하기 귀찮다면 ",(0,n.jsx)(s.code,{children:"Skip"})," 버튼을 클릭하고, 변경할 것이라면 ",(0,n.jsx)(s.code,{children:"New password"}),", ",(0,n.jsx)(s.code,{children:"Confirm new password"})," 를 모두 입력하고 ",(0,n.jsx)(s.code,{children:"Submit"})," 버튼을 눌러서 비밀번호 변경을 완료합니다.\r\n",(0,n.jsx)(s.img,{placeholder:"blur",src:h})]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsx)(s.h3,{id:"dashboard-생성-prometheus-세팅",children:"Dashboard 생성, Prometheus 세팅"}),"\n",(0,n.jsxs)(s.p,{children:["새로 나타난 페이지에서는 ",(0,n.jsx)(s.code,{children:"Dashboard > Create your first dashboard"})," 를 클릭해서 대시보드 설정 페이지로 이동합니다.",(0,n.jsx)("br",{}),"\r\n",(0,n.jsx)(s.img,{placeholder:"blur",src:d})]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"Import a dashboard"})," 를 클릭합니다.\r\n",(0,n.jsx)(s.img,{placeholder:"blur",src:p})]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsxs)(s.p,{children:["새로 나타난 페이지에서 ",(0,n.jsx)(s.code,{children:"4701"})," 을 입력하고 ",(0,n.jsx)(s.code,{children:"Load"})," 버튼을 클릭합니다.\r\n",(0,n.jsx)(s.img,{placeholder:"blur",src:x})]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"Configure a new datasource"})," 버튼을 클릭합니다.\r\n",(0,n.jsx)(s.img,{placeholder:"blur",src:k})]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsxs)(s.p,{children:["나타난 datasource 선택 화면에서 ",(0,n.jsx)(s.code,{children:"Prometheus"})," 를 선택합니다.",(0,n.jsx)("br",{}),"\r\n",(0,n.jsx)(s.img,{placeholder:"blur",src:j})]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsxs)(s.p,{children:["Prometheus URL 은 ",(0,n.jsx)(s.a,{href:"http://host.docker.internal:9090",children:"http://host.docker.internal:9090"})," 을 입력해줍니다.\r\n",(0,n.jsx)(s.img,{placeholder:"blur",src:y})]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsxs)(s.p,{children:["스크롤을 아래로 내려서 ",(0,n.jsx)(s.code,{children:"Save & test"})," 버튼을 클릭해서 Prometheus 설정을 마무리합니다.\r\n",(0,n.jsx)(s.img,{placeholder:"blur",src:m})]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsxs)(s.p,{children:["다시 홈으로 이동 후  ",(0,n.jsx)(s.code,{children:"Dashboard > Create your first dashboard"})," 를 클릭해서 대시보드 설정 페이지로 이동합니다.",(0,n.jsx)("br",{}),"\r\n그리고 ",(0,n.jsx)(s.code,{children:"Import a dashboard"})," 를 클릭합니다.",(0,n.jsx)("br",{}),"\r\n",(0,n.jsx)(s.img,{placeholder:"blur",src:g})]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.code,{children:"prometheus"})," 를 선택하고 ",(0,n.jsx)(s.code,{children:"Import"})," 버튼을 클릭합니다.\r\n",(0,n.jsx)(s.img,{placeholder:"blur",src:A})]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsxs)(s.p,{children:["설정이 완료되면 아래와 같은 화면이 나타납니다.\r\n",(0,n.jsx)(s.img,{placeholder:"blur",src:u})]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsx)(s.h2,{id:"prometheus-대시보드",children:"Prometheus 대시보드"}),"\n",(0,n.jsxs)(s.p,{children:["Prometheus 대시보드는 ",(0,n.jsx)(s.a,{href:"http://localhost:9090/",children:"http://localhost:9090/"})," 으로 접속하시면 됩니다.",(0,n.jsx)("br",{}),"\r\n그리고 상단의 ",(0,n.jsx)(s.code,{children:"Status"})," 클릭 → ",(0,n.jsx)(s.code,{children:"Targets"})," 클릭을 차례로 수행해주시면 됩니다.",(0,n.jsx)("br",{}),"\r\n![](./img/PROMETHEUS-SCREENSHOT/1.그리고 상단의 ",(0,n.jsx)(s.code,{children:"Status"})," 클릭 → ",(0,n.jsx)(s.code,{children:"Targets"})," 클릭 png)"]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsxs)(s.p,{children:["아래에 나타나는 api 들은 모두 ",(0,n.jsx)(s.code,{children:"monitoring/prometheus/config/config.yml"})," 에 미리 지정해준 내용을 기반으로 세팅된 내용들입니다",(0,n.jsx)("br",{}),"\r\n",(0,n.jsx)(s.img,{placeholder:"blur",src:v})]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsx)(s.h2,{id:"지표들을-지우고-싶다면",children:"지표들을 지우고 싶다면"}),"\n",(0,n.jsxs)(s.p,{children:["prometheus, grafana 와 같은 시계열 데이터를 저장하는 플랫폼들은 대부분 측정한 지표들을 디스크내에 증분방식으로 쌓아둡니다. 우리가 작성한 docker-compose 파일 내에도 ",(0,n.jsx)(s.code,{children:"volume"})," 항목을 보면 이런 내용들을 저장하는 부분들에 대한 내용이 있습니다.\r\n",(0,n.jsx)(s.img,{placeholder:"blur",src:w})]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsxs)(s.p,{children:["위에서 표시된 부분에 쌓인 데이터들을 지우려면 각각의 ",(0,n.jsx)(s.code,{children:"volume"})," 디렉터리를 삭제해주시면 됩니다.",(0,n.jsx)("br",{})]}),"\n",(0,n.jsx)("br",{})]})}let N={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,a.a)(),e.components);return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(_createMdxContent,{...e})}):_createMdxContent(e)},pageOpts:{filePath:"pages/project-overview/prometheus-grafana-setting.mdx",route:"/project-overview/prometheus-grafana-setting",timestamp:1707897272e3,pageMap:[{kind:"MdxPage",name:"about",route:"/about"},{kind:"Folder",name:"coding-style",route:"/coding-style",children:[{kind:"MdxPage",name:"factory-mapper-usage",route:"/coding-style/factory-mapper-usage"},{kind:"MdxPage",name:"multi-module-usage",route:"/coding-style/multi-module-usage"},{kind:"MdxPage",name:"simplify-object-dependency",route:"/coding-style/simplify-object-dependency"},{kind:"Meta",data:{"service-object-usage":"객체 간 의존성 단순화 (순환참조 방지)","factory-mapper-usage":"객체생성은 factory, mapper 컴포넌트를 사용","multi-module-usage":"멀티모듈 구성 원칙","simplify-object-dependency":"Simplify Object Dependency"}}]},{kind:"MdxPage",name:"index",route:"/"},{kind:"Folder",name:"performance-test",route:"/performance-test",children:[{kind:"MdxPage",name:"grafana-dashboard-setting",route:"/performance-test/grafana-dashboard-setting"},{kind:"MdxPage",name:"locust-setting",route:"/performance-test/locust-setting"},{kind:"MdxPage",name:"testing-note",route:"/performance-test/testing-note"},{kind:"Meta",data:{"grafana-dashboard-setting":"Grafana Dashboard 세팅","locust-setting":"locust 세팅","testing-note":"테스팅 노트"}}]},{kind:"Folder",name:"project-overview",route:"/project-overview",children:[{kind:"MdxPage",name:"locust-setting",route:"/project-overview/locust-setting"},{kind:"MdxPage",name:"module-structure",route:"/project-overview/module-structure"},{kind:"MdxPage",name:"prometheus-grafana-setting",route:"/project-overview/prometheus-grafana-setting"},{kind:"MdxPage",name:"tech-stack",route:"/project-overview/tech-stack"},{kind:"Meta",data:{"tech-stack":"Tech Stack","module-structure":"멀티 모듈 구조","locust-setting":"locust 세팅","prometheus-grafana-setting":"prometheus, grafana 세팅"}}]},{kind:"Folder",name:"redis-summary",route:"/redis-summary",children:[{kind:"MdxPage",name:"redis-data-structures",route:"/redis-summary/redis-data-structures"},{kind:"MdxPage",name:"spring-data-redis",route:"/redis-summary/spring-data-redis"},{kind:"Meta",data:{"redis-data-structures":"레디스 자료구조들","spring-data-redis":"Spring Data Redis"}}]},{kind:"Meta",data:{index:"Introduction","project-overview":"Project Overview","coding-style":"코딩스타일","performance-test":"성능테스트","redis-summary":"레디스 관련 개념들",about:{title:"About",type:"page"},contact:{title:"Contact ↗",type:"page",href:"-",newWindow:!0}}}],flexsearch:{codeblocks:!0},title:"Prometheus Grafana Setting",headings:b},pageNextRoute:"/project-overview/prometheus-grafana-setting",nextraLayout:o.ZP,themeConfig:l.Z};var f=(0,i.j)(N)},8426:function(e,s,r){"use strict";var n=r(5893);r(7294);let i={logo:(0,n.jsx)("span",{children:"My Project"}),project:{link:"https://github.com/chagchagchag/docs-coupon-service"},docsRepositoryBase:"https://github.com/chagchagchag/docs-coupon-service",footer:{text:"Nextra Docs Template"}};s.Z=i},5789:function(){}},function(e){e.O(0,[774,796,888,179],function(){return e(e.s=5667)}),_N_E=e.O()}]);